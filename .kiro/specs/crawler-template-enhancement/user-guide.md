# 采集模板配置增强 - 用户使用指南

## 功能概述

采集模板配置增强功能提供了一个直观、强大的界面，用于配置和管理网页数据采集模板。主要特性包括：

- **左右分栏布局**：配置和预览同时可见
- **AI智能分析**：自动识别网页结构并推荐字段
- **实时预览**：配置变化立即预览效果
- **元素可视化选择**：点击网页元素自动生成选择器
- **失败诊断**：AI分析采集失败原因并提供修复建议
- **响应式设计**：适配各种屏幕尺寸
- **键盘快捷键**：提高操作效率

---

## 快速开始

### 1. 创建新模板

1. 在模板列表页面，点击"新增模板"按钮
2. 进入编辑页面，左侧为配置表单，右侧为预览面板

### 2. 配置基本信息

在左侧配置表单中填写：

- **模板名称**（必填）：例如"国家数据局政策文件"
- **目标URL**（必填）：要采集的网页地址
- **归属部门**：例如"数据管理部"
- **数据类型**：例如"政策文件"

### 3. 配置选择器（两种方式）

#### 方式一：AI智能分析（推荐）

1. 输入目标URL后，点击"AI智能分析"按钮
2. AI会自动分析网页结构，推荐字段和选择器
3. 查看推荐结果，可以：
   - 点击"应用全部推荐"一键应用所有字段
   - 单独应用某个推荐字段
   - 编辑推荐的选择器

#### 方式二：手动配置

1. **配置容器选择器**：定位列表项的CSS选择器
   - 例如：`ul.list > li` 或 `.article-list .item`

2. **配置字段选择器**：
   - 点击"添加字段"按钮
   - 输入字段名称（如"标题"）
   - 输入字段选择器（如`h3.title`）
   - 可以使用特殊语法：
     - `a::attr(href)` - 获取链接地址
     - `img::attr(src)` - 获取图片地址
     - `.date::text` - 获取文本内容

3. **使用元素选择器**（可选）：
   - 在右侧"网页预览"标签页中
   - 点击"启用元素选择器"按钮
   - 鼠标悬停在网页元素上会高亮显示
   - 点击元素自动生成选择器并填充到表单

### 4. 配置分页（可选）

如果需要采集多页数据：

1. 勾选"启用分页"
2. 配置"下一页选择器"：定位"下一页"按钮的选择器
3. 设置"最大页数"：限制采集的最大页数（默认50页）

### 5. 预览数据

在右侧预览面板中：

- **网页预览**：查看目标网页
- **选择器可视化**：查看所有配置的选择器及其验证状态
- **数据预览**：查看采集到的数据（默认显示10条）

配置变化后会自动预览（1秒防抖），也可以手动刷新。

### 6. 测试配置

1. 点击顶部"测试配置"按钮（或按 Ctrl+T）
2. 系统会执行完整的采集测试
3. 弹窗显示测试结果：
   - 成功：显示采集到的数据条数和数据表格
   - 失败：显示错误信息

### 7. 保存模板

1. 确认配置无误后，点击"保存模板"按钮（或按 Ctrl+S）
2. 系统会自动：
   - 保存模板配置
   - 执行一次预览
   - 切换到"数据预览"标签页
   - 刷新模板列表

---

## 高级功能

### AI失败诊断

当数据预览失败时：

1. 在"数据预览"标签页会显示"AI诊断"按钮
2. 点击按钮，AI会分析失败原因
3. 查看诊断结果：
   - 失败原因分析
   - 具体问题列表
   - 修复建议
   - 推荐的采集策略
4. 点击"应用推荐策略"一键应用修复方案

### 选择器验证

每个选择器输入框都会实时验证：

- ✅ 绿色：选择器有效，显示匹配元素数量
- ⚠️ 黄色：选择器有效但匹配数量为0
- ❌ 红色：选择器无效或验证失败

### 面板折叠/展开

在编辑页面：

- 点击左侧面板的"收起"按钮，折叠配置表单
- 点击右侧面板的"收起"按钮，折叠预览面板
- 折叠后另一个面板会自动扩展，充分利用屏幕空间

---

## 键盘快捷键

在编辑模式下：

- **Ctrl+S**：保存模板
- **Ctrl+T**：测试配置
- **Esc**：关闭弹窗或返回列表

---

## 响应式设计

系统会根据屏幕尺寸自动调整布局：

- **大屏幕（>1400px）**：左右分栏布局
- **中等屏幕（768px-1400px）**：上下分栏布局
- **小屏幕（<768px）**：垂直布局，优化移动端显示

---

## 常见问题

### Q: 为什么数据预览显示"未采集到数据"？

A: 可能的原因：
1. 容器选择器不正确，无法定位到列表项
2. 字段选择器不正确，无法提取数据
3. 网页使用了动态加载（JavaScript渲染）

**解决方案**：
- 使用"AI诊断"功能分析问题
- 检查选择器是否匹配元素（查看验证状态）
- 使用"元素选择器"重新选择元素

### Q: 如何采集动态加载的网页？

A: 对于JavaScript渲染的网页：
1. 系统会自动检测并提示
2. AI诊断会推荐使用"等待选择器"策略
3. 应用推荐策略后重新测试

### Q: 选择器语法有哪些？

A: 支持标准CSS选择器，以及特殊语法：
- `::attr(属性名)` - 获取元素属性
- `::text` - 获取文本内容（默认）
- 例如：
  - `a::attr(href)` - 获取链接
  - `img::attr(src)` - 获取图片
  - `.date::text` - 获取日期文本

### Q: 如何提高采集成功率？

A: 建议：
1. 使用"AI智能分析"自动识别字段
2. 使用"元素选择器"精确选择元素
3. 配置后先"测试"再"保存"
4. 遇到问题使用"AI诊断"获取修复建议

---

## 技术支持

如有问题或建议，请联系技术支持团队。
